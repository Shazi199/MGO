#include("../common/_layout.html")
#include("../common/_navbar.html")
#@layout()

#define content()
	#@navbar("summon")
	<div class="container">
		<h1>#(pool.name ??)</h1>
		<div class="btn-group btn-group-lg btn-group-justified" role="group" aria-label="...">
			<a class="btn btn-default" href="#" id="drawOne">召唤　1　次</a>
			<a class="btn btn-default" href="#" id="drawTen">召唤　10　次</a>
		</div>
		<div class="row" id="result">
		</div>
	</div>
	<script type="text/javascript">
		var poolId = #(pool.id ??);
		function generateCard(card) {
			var cardInfo = getCardInfo(card.type, card.id);
			var html = '<div class="col-sm-2 col-md-2"><div class="thumbnail rareColor'+cardInfo.rare+'">'
			html += '<p>'+cardInfo.name+'</p>';
			html += '<p></p>';
			html += '<p class="starColor">'+rareSHOW[cardInfo.rare]+'</p>';
			html += '</div></div>';
			return html;
		}
		function getCardInfo(type,id){
			return DATA_DB[type][id];
		}
		var rareSHOW={"1":"★","2":"★★","3":"★★★","4":"★★★★","5":"★★★★★"};
		$("#drawOne").click(function(e){
			$.post("summon/drawOne",{"poolId":poolId},function(data){
				if(data.isFail){
					alert(data.msg);
					return;
				}
				updateUserStone();
				var html = generateCard(data);
				$("#result").html(html);
			});
		});
		$("#drawTen").click(function(e){
			$.post("summon/drawTen",{"poolId":poolId},function(data){
				if(data.isFail){
					alert(data.msg);
					return;
				}
				updateUserStone();
				var html = "";
				for(var i=0;i<data.length;i++){
					html += generateCard(data[i]);
				}
				$("#result").html(html);
			});
		});
	</script>
	<script src="js/db.js"></script>
#end

#define css()
<style type="text/css">
.starColor {
	color: #FFFF00;
}
.rareColor1 {
	background-color: #663300;
}
.rareColor2 {
	background-color: #663300;
}
.rareColor3 {
	background-color: #999999;
}
.rareColor4 {
	background-color: #FF9900;
}
.rareColor5 {
	background-color: #FF9900;
}
</style>
#end